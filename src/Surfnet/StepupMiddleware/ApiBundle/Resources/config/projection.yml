services:
    stepup.repository.identifying_data:
        public: false
        class: Surfnet\Stepup\IdentifyingData\Entity\IdentifyingDataRepository
        factory_service: doctrine.orm.entity_manager
        factory_method:  getRepository
        arguments:
            - 'Surfnet\Stepup\IdentifyingData\Entity\IdentifyingData'

    surfnet_stepup_middleware_api.projector.identity:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\IdentityProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.identity
            - @stepup.repository.identifying_data
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.institution_listing:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\InstitutionListingProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.institution_listing
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.second_factor:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\SecondFactorProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.unverified_second_factor
            - @surfnet_stepup_middleware_api.repository.verified_second_factor
            - @surfnet_stepup_middleware_api.repository.vetted_second_factor
            - @surfnet_stepup_middleware_api.repository.identity
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.ra_second_factor:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\RaSecondFactorProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.ra_second_factor
            - @surfnet_stepup_middleware_api.repository.identity
            - @stepup.repository.identifying_data
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.ra_listing:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\RaListingProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.ra_listing
            - @surfnet_stepup_middleware_api.repository.identity
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.ra_candidate:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\RaCandidateProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.ra_candidate
            - @stepup.repository.identifying_data
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.ra:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\RaProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.ra
        tags: [{ name: event_bus.event_listener }]


    surfnet_stepup_middleware_api.projector.raa:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\RaaProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.raa
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.sraa:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\SraaProjector
        arguments:
            - @surfnet_stepup_middleware_api.repository.sraa
        tags: [{ name: event_bus.event_listener }]

    surfnet_stepup_middleware_api.projector.audit_log:
        class: Surfnet\StepupMiddleware\ApiBundle\Identity\Projector\AuditLogProjector
        arguments: [ @surfnet_stepup_middleware_api.repository.audit_log ]
        tags: [{ name: event_bus.event_listener }]
