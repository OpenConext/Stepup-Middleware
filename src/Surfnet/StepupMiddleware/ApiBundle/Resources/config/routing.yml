command_handle:
    path: /command
    defaults:  { _controller: SurfnetStepupMiddlewareApiBundle:Command:handle }
    methods:   [POST]
    condition: "request.headers.get('Content-Type') == 'application/json' && request.headers.get('Accept') matches '/^application\\\\/json($|[;,])/'"

identity:
    path:     /identity/{id}
    defaults: { _controller: SurfnetStepupMiddlewareApiBundle:Identity:get }
    methods:  [GET]
    requirements:
        id: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
    condition: "request.headers.get('Accept') matches '/^application\\\\/json($|[;,])/'"

identity_collection:
    path:     /identity
    defaults: { _controller: SurfnetStepupMiddlewareApiBundle:Identity:collection }
    methods:  [GET]
    condition: "request.headers.get('Accept') matches '/^application\\\\/json($|[;,])/'"

identity_second_factors:
    path:     /identity/{identityId}/second-factors
    defaults: { _controller: SurfnetStepupMiddlewareApiBundle:SecondFactor:findByIdentity }
    methods:  [GET]
    condition: "request.headers.get('Accept') matches '/^application\\\\/json($|[;,])/'"

identity_unverified_second_factors:
    path:     /identity/{identityId}/unverified-second-factors
    defaults: { _controller: SurfnetStepupMiddlewareApiBundle:SecondFactor:findUnverifiedByIdentity }
    methods:  [GET]
    condition: "request.headers.get('Accept') matches '/^application\\\\/json($|[;,])/'"
